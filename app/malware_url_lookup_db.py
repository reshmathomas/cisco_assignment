from db_conn_config import db


def is_url_malware(url):
    cursor = db.cursor()
    query = "SELECT COUNT(*) from malware_urls.malware_url_info where url = %s"
    cursor.execute(query, (url,))

    result = cursor.fetchone()

    try:
        cursor.close()
    except:
        pass

    if (result[0]):
        return True
    else:
        return False


def add_malware_url(url):
    cursor = db.cursor()
    query = "INSERT INTO malware_urls.malware_url_info (url) VALUES (%s)"
    try:
        cursor.execute(query, (url,))
    except:
        print("Entry for url : "+url+" already exists.")

    db.commit()
    try:
        cursor.close()
    except:
        pass
    return "SUCCESS"
