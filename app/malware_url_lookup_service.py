import re


class malware_url_lookup_service:

    def __init__(self, url):
        self.url = url

    def validate(self):
        """
        Validate whether the given URL is in a valid format
        """
        regex = r'^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$'

        url_valid = re.match(regex, self.url)

	# Strip domain.tld from the URL to match against the DB entries
        # This is to ensure that https://www.abcd.com is treated the same as www.abcd.com
        if url_valid:
            if url_valid.group(2) is not None:
                domain = url_valid.group(2).strip(r'www\d?.')
            if url_valid.group(3) is not None:
                tld = url_valid.group(3)
            url_db = domain + "." + tld
        else:
            print ("Enter valid URL in format (http://domain.tld)")
            raise

        # TODO: Connect db and search the domain is in list of malwares
	print "Checking in DB whether URL is a malware"
        return False
