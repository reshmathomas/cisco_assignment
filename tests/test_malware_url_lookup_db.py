import unittest
import sys
sys.path.append("..")

from app.db_conn_config import db
from app.malware_url_lookup_db import is_url_malware


class Test_Malware_Url_Lookup_Db(unittest.TestCase):
    def test_is_url_malware(self):
        url = "www.fakeurl.com"
        cursor = db.cursor()
        cursor.execute("INSERT INTO malware_urls.malware_url_info values(%s);", (url,))
        cursor.close()
        self.assertEqual(is_url_malware(url), True)


    def test_is_url_not_malware(self):
        url = "www.abcd.com"
        self.assertEqual(is_url_malware(url), False)

if __name__ == '__main__':
    unittest.main()
